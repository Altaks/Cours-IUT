Oracle 12c introduit la possibilité de définir une clause d’identité sur une colonne de table définie à l’aide d’un type numérique.

Syntaxe SQL :

```sql
GENERATED 
	[ ALWAYS | BY DEFAULT [ ON NULL ] ] 
	AS IDENTITY [ ( identity_options ) ]

-- identity_options correspond à presque toutes les options de l'ordre CREATE SEQUENCE 
```

>[!caution] Attention
>Pour créer une colonne d’identité, il faut posséder le privilège `CREATE SEQUENCE`.

---
### Colonne d'identité : Cas `ALWAYS`

Utiliser `ALWAYS` force l’utilisation de l’identité : si une instruction `INSERT` fait référence à la colonne identity, mˆeme pour spécifier une valeur `NULL`, une erreur est produite

```SQL
SQL> create table identity_test_table ( 
	 	 id number GENERATED ALWAYS AS IDENTITY, 
	 	 description varchar2(30) 
	 ); 

SQL> insert into identity_test_table (id, description) 
	 values (1, ’desc1);

ERROR at line 1: 
ORA-32795: cannot insert into a generated always identity column
```

---
### Colonne d'identité : Cas  `BY DEFAULT`

- L’utilisation de `BY DEFAULT` permet d’utiliser l’identité si la colonne n’est pas référencée dans l’instruction `INSERT`.
- Si la colonne est référencée, la valeur spécifiée sera utilisée à la place de l’identité
- Tenter de spécifier la valeur `NULL` dans ce cas entraîne une erreur, puisque les colonnes d’identité sont toujours `NOT NULL` .

```sql
SQL> create table identity_test_table ( 
		id number GENERATED BY DEFAULT AS IDENTITY, 
		description varchar2(30) 
	);
```

---
### Colonne d'identité : Cas  `BY DEFAULT ON NULL`

L’utilisation de `BY DEFAULT ON NULL` permet d’utiliser l’identité si la colonne d’identité est référencée, mais une valeur `NULL` est spécifiée.

```sql
SQL> create table identity_test_table ( 
		id number GENERATED BY DEFAULT ON NULL AS IDENTITY, 
		description varchar2(30) 
	);
```

**Cours à voir :**
- [[1.5. Administrer les séquences]]