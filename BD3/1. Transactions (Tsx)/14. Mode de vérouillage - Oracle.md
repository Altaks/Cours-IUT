### Verrouillage d'une table en mode exclusif (Exclusive)

Ordre SQL :

```sql
LOCK TABLE table IN EXCLUSIVE MODE [NOWAIT]` ;
```

Ce mode est utilisé lorsqu’on veut modifier des données de la table en
s'assurant qu'aucune autre modification ne sera apportée sur la table par
les autres utilisateurs ; en effet, dans ce mode :
- celui qui a bloqué la table peut insérer, supprimer ou consulter ;
- les autres ne peuvent que consulter la table. Ils sont aussi bloqués
s'ils veulent bloquer la même table.

Ce mode étant très contraignant pour les autres utilisateurs (ils sont mis en
attente et ne reprennent la main qu'au déblocage de la table), le blocage
doit être le plus court possible. Un blocage en mode exclusif doit être suivi
rapidement d'un `COMMIT` ou d'un `ROLLBACK`.

Pour les 5 modes de blocage, l'option `NOWAIT` (ajoutée à la fin de la
commande `LOCK`) permet de prendre immédiatement la main sur une
table au cas où la table que l'on veut bloquer ne serait pas bloquée.

---

### Verrouillage d'une table en mode `Share Row Exclusive`

Ordre SQL :

```sql
LOCK TABLE table IN SHARE ROW EXCLUSIVE MODE [NOWAIT] ;
```

Ce blocage empêche tous les autres blocages sur les tables sauf le mode `Row Share`. Il empêche donc toute modification sur les tables. Il n'est pas très utilisé.

---

### Verrouillage d'une table en mode `Share`

Ordre SQL :

```sql
LOCK TABLE table IN SHARE MODE [NOWAIT] ;
```

Ce mode interdit toute modification de la table, y compris par celui qui a bloqué la table. On peut l'utiliser lorsqu’on veut, par exemple, établir un bilan des données contenue dans une table.  

L'avantage par rapport au mode exclusif est qu’on n'est pas mis en attente si la table est déjà
bloquée en mode partagé.

---
### Verrouillage d'une table en mode `Row Exclusive`

Ordre SQL :

```sql
LOCK TABLE table IN ROW EXCLUSIVE MODE [NOWAIT] ;
```

C'est le blocage qui est executé automatiquement par Oracle avant d'exécuter un ordre `INSERT`, `DELETE` ou `UPDATE`.

Il permet de modifier certaines lignes pendant que d'autres utilisateurs modifient d'autres lignes.

Il empêche les autres de bloquer en mode `Share`, `Share Row Exclusive` et `Exclusive`.

---

### Verrouillage d'une table en mode `Share Row`

Ordre SQL :

```sql
LOCK TABLE table IN ROW SHARE MODE [NOWAIT] ;
```

Ce mode empêche le blocage de la table en mode `Exclusif`.

C'est le mode implicite de blocage de la table de la commande `SELECT FOR UPDATE`.

**Cours à voir :**
- [[15. Commande SELECT FOR UDPATE]]